apiVersion: agent.atomix.io/v1alpha1
kind: AtomixCluster
metadata:
  name: example-atomixcluster
spec:
  version: latest
  managementGroup:
    size: 1
    storage:
      className: fast-disks
  partitionGroups:
    - name: raft
      size: 3
      partitions: 3
      env:
        - name: JAVA_OPTS
          value: -Xmx2G
      resources:
        requests:
          memory: 2Gi
          cpu: .5
      raft:
        storage:
          className: fast-disks
  chaos:
    monkeys:
      - name: crash
        rateSeconds: 60
        selector:
          matchGroups:
            - raft
        crash:
          crashStrategy:
            type: Pod
      - name: partition-bridge
        rateSeconds: 600
        partition:
          partitionStrategy:
            type: Bridge
      - name: partition-isolate
        rateSeconds: 300
        periodSeconds: 300
        partition:
          partitionStrategy:
            type: Isolate
      - name: stress-node
        rateSeconds: 60
        periodSeconds: 10
        stress:
          cpu:
            workers: 1
      - name: stress-network
        rateSeconds: 60
        periodSeconds: 10
        stress:
          stressStrategy:
            type: All
          network:
            latencyMilliseconds: 500